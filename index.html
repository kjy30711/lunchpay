<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>ÏõîÎßê Ï†êÏã¨Í∞í Í≥ÑÏÇ∞Í∏∞</title>

<style>
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', 'Noto Sans KR', 'Segoe UI', sans-serif;
    max-width: 640px;
    margin: 0 auto;
    padding: 20px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    color: #333;
    font-size: 16px;
    line-height: 1.6;
    letter-spacing: -0.3px;
  }

  .card {
    background: rgba(255,255,255,0.97);
    border-radius: 20px;
    padding: 28px 24px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    backdrop-filter: blur(10px);
  }

  .title-area {
    text-align: center;
    margin-bottom: 24px;
    position: relative;
  }

  h1 {
    font-size: 28px;
    color: #2d3748;
    letter-spacing: -0.5px;
    font-weight: 800;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    cursor: default;
  }

  .title-display {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    justify-content: center;
  }

  .title-display .company-text {
    font-size: 28px;
    font-weight: 800;
    color: #2d3748;
    letter-spacing: -0.5px;
  }

  .title-display .btn-edit-title {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    border: none;
    background: #edf2f7;
    color: #718096;
    font-size: 14px;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    transition: all 0.2s;
    flex-shrink: 0;
  }

  .title-display .btn-edit-title:hover {
    background: #e2e8f0;
    color: #4a5568;
  }

  .section-label {
    font-size: 15px;
    font-weight: 800;
    color: #4a5568;
    letter-spacing: 0.5px;
    margin-bottom: 10px;
    display: block;
  }

  .input-group {
    display: flex;
    gap: 8px;
    margin-bottom: 16px;
    align-items: stretch;
  }

  input[type="number"],
  input[type="text"] {
    flex: 1;
    padding: 0 14px;
    font-size: 16px;
    font-weight: 500;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
    background: #f7fafc;
    min-width: 0;
    font-family: inherit;
    letter-spacing: -0.2px;
    height: 44px;
  }

  input:focus {
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102,126,234,0.15);
    background: #fff;
  }

  button {
    padding: 0 18px;
    font-size: 15px;
    font-weight: 700;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    font-family: inherit;
    letter-spacing: -0.2px;
    height: 44px;
  }

  button:active { transform: scale(0.96); }

  .btn-primary {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    box-shadow: 0 4px 15px rgba(102,126,234,0.4);
  }
  .btn-primary:hover { box-shadow: 0 6px 20px rgba(102,126,234,0.6); }

  .btn-cancel-inline {
    background: #edf2f7 !important;
    color: #4a5568 !important;
    box-shadow: none !important;
  }
  .btn-cancel-inline:hover { background: #e2e8f0 !important; }

  .btn-danger {
    background: #fed7d7;
    color: #c53030;
    box-shadow: none;
  }
  .btn-danger:hover { background: #feb2b2; }

  .btn-add {
    background: linear-gradient(135deg, #48bb78, #38a169);
    color: white;
    box-shadow: 0 4px 15px rgba(72,187,120,0.4);
  }
  .btn-add:hover { box-shadow: 0 6px 20px rgba(72,187,120,0.6); }

  .btn-group {
    display: flex;
    gap: 8px;
    margin-bottom: 16px;
  }

  .btn-reset { flex: 1; background: #fed7d7; color: #c53030; }
  .btn-reset:hover { background: #feb2b2; }
  .btn-copy { flex: 1; background: #c6f6d5; color: #276749; }
  .btn-copy:hover { background: #9ae6b4; }
  .btn-export { flex: 1; background: #bee3f8; color: #2b6cb0; }
  .btn-export:hover { background: #90cdf4; }

  .divider {
    height: 1px;
    background: linear-gradient(90deg, transparent, #e2e8f0, transparent);
    margin: 20px 0;
  }

  .saved-display {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 0 16px;
    background: #f7fafc;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    font-size: 16px;
    font-weight: 600;
    color: #2d3748;
    margin-bottom: 8px;
    height: 44px;
    overflow: hidden;
    white-space: nowrap;
  }

  .saved-display .saved-text {
    flex: 1;
    letter-spacing: -0.2px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .btn-edit-pencil {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    border: none;
    background: #edf2f7;
    color: #718096;
    font-size: 14px;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    transition: all 0.2s;
    flex-shrink: 0;
  }

  .btn-edit-pencil:hover {
    background: #e2e8f0;
    color: #4a5568;
  }

  /* ÏùÄÌñâ ÌÅ¥Î¶≠Ìòï ÎìúÎ°≠Îã§Ïö¥ */
  .bank-select {
    position: relative;
    flex: 0 0 auto;
    width: 120px;
  }

  .bank-select-trigger {
    width: 100%;
    height: 44px;
    padding: 0 32px 0 12px;
    font-size: 15px;
    font-weight: 600;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    background: #f7fafc;
    color: #2d3748;
    cursor: pointer;
    display: flex;
    align-items: center;
    transition: all 0.2s;
    font-family: inherit;
    letter-spacing: -0.2px;
    user-select: none;
    position: relative;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .bank-select-trigger::after {
    content: "‚ñæ";
    position: absolute;
    right: 10px;
    font-size: 13px;
    color: #a0aec0;
    pointer-events: none;
    transition: transform 0.2s;
  }

  .bank-select.open .bank-select-trigger::after {
    transform: rotate(180deg);
  }

  .bank-select-trigger:hover {
    border-color: #cbd5e0;
    background: #edf2f7;
  }

  .bank-select.open .bank-select-trigger {
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102,126,234,0.15);
    background: #fff;
  }

  .bank-select-trigger.placeholder {
    color: #a0aec0;
    font-weight: 500;
  }

  .bank-select-dropdown {
    position: absolute;
    top: calc(100% + 4px);
    left: 0;
    width: 200px;
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    max-height: 240px;
    overflow-y: auto;
    z-index: 100;
    display: none;
    box-shadow: 0 12px 28px rgba(0,0,0,0.12);
    padding: 6px;
  }

  .bank-select.open .bank-select-dropdown {
    display: block;
    animation: dropIn 0.15s ease;
  }

  @keyframes dropIn {
    from { opacity: 0; transform: translateY(-6px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .bank-select-item {
    padding: 9px 12px;
    font-size: 15px;
    font-weight: 500;
    cursor: pointer;
    border-radius: 8px;
    transition: background 0.1s;
    font-family: inherit;
    color: #2d3748;
    letter-spacing: -0.2px;
  }

  .bank-select-item:hover {
    background: #edf2f7;
  }

  .bank-select-item.selected {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    font-weight: 700;
  }

  .bank-select-item.selected:hover {
    opacity: 0.9;
  }

  #accountNumber { flex: 1; min-width: 0; }
  #accountHolder { flex: 0 0 auto; width: 80px; }

  .summary-banner {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 14px;
    padding: 14px 20px;
    margin-bottom: 14px;
    display: flex;
    justify-content: space-around;
    color: white;
    text-align: center;
  }

  .summary-item {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .summary-item .label {
    font-size: 13px;
    font-weight: 600;
    opacity: 0.9;
    letter-spacing: 0.5px;
  }

  .summary-item .value {
    font-size: 26px;
    font-weight: 900;
    letter-spacing: -0.5px;
  }

  table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    margin-top: 6px;
  }

  thead th {
    background: #f7fafc;
    padding: 14px 8px;
    font-size: 14px;
    font-weight: 800;
    color: #4a5568;
    letter-spacing: 0.3px;
    border-bottom: 2px solid #e2e8f0;
    position: sticky;
    top: 0;
    z-index: 1;
  }

  thead th:first-child { border-radius: 12px 0 0 0; }
  thead th:last-child { border-radius: 0 12px 0 0; }

  tbody tr { transition: background 0.15s; }
  tbody tr:hover { background: #f0f4ff; }
  tbody tr.highlight { animation: highlightFade 1s ease; }

  @keyframes highlightFade {
    0% { background: #c6f6d5; }
    100% { background: transparent; }
  }

  td {
    padding: 12px 8px;
    text-align: center;
    border-bottom: 1px solid #edf2f7;
    font-size: 16px;
    font-weight: 500;
    vertical-align: middle;
    letter-spacing: -0.2px;
  }

  td:first-child { font-weight: 700; color: #2d3748; }

  .counter-control {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 2px;
  }

  .counter-btn {
    width: 34px;
    height: 34px;
    border-radius: 50%;
    border: none;
    font-size: 20px;
    font-weight: 800;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    transition: all 0.15s;
    flex-shrink: 0;
  }

  .counter-btn:active { transform: scale(0.9); }
  .counter-minus { background: #fed7d7; color: #c53030; }
  .counter-minus:hover { background: #feb2b2; }
  .counter-plus { background: #c6f6d5; color: #276749; }
  .counter-plus:hover { background: #9ae6b4; }

  .counter-control input[type="number"] {
    width: 52px;
    text-align: center;
    padding: 0 4px;
    font-size: 18px;
    font-weight: 800;
    border: 2px solid #e2e8f0;
    border-radius: 10px;
    background: #fff;
    flex: 0 0 auto;
    height: 34px;
    -moz-appearance: textfield;
  }

  .counter-control input[type="number"]::-webkit-outer-spin-button,
  .counter-control input[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }

  .total-cell {
    font-weight: 800;
    color: #2d3748;
    font-size: 16px;
    letter-spacing: -0.3px;
  }

  .btn-delete {
    width: 34px;
    height: 34px;
    border-radius: 50%;
    border: none;
    background: #fff5f5;
    color: #e53e3e;
    font-size: 16px;
    cursor: pointer;
    padding: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transition: all 0.15s;
  }

  .btn-delete:hover { background: #fed7d7; }
  .btn-delete:active { transform: scale(0.9); }

  .empty-state {
    text-align: center;
    padding: 40px 20px;
    color: #a0aec0;
  }
  .empty-state .icon { font-size: 48px; margin-bottom: 12px; }
  .empty-state p { font-size: 16px; line-height: 1.7; font-weight: 500; }

  .toast {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%) translateY(100px);
    background: #2d3748;
    color: white;
    padding: 0 28px;
    border-radius: 14px;
    font-size: 15px;
    font-weight: 700;
    box-shadow: 0 10px 40px rgba(0,0,0,0.3);
    z-index: 1000;
    opacity: 0;
    transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    pointer-events: none;
    white-space: nowrap;
    font-family: inherit;
    height: 48px;
    display: flex;
    align-items: center;
  }

  .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }
  .toast.success { background: #38a169; }
  .toast.error { background: #e53e3e; }
  .toast.info { background: #3182ce; }

  .drag-handle { cursor: grab; color: #cbd5e0; font-size: 16px; user-select: none; padding: 0 4px; }
  .drag-handle:active { cursor: grabbing; }
  tbody tr.dragging { opacity: 0.5; background: #edf2f7; }
  tbody tr.drag-over { border-top: 3px solid #667eea; }

  .btn-full-reset {
    width: 100%;
    height: 44px;
    background: #fff5f5;
    color: #c53030;
    border: 2px dashed #fed7d7;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    margin-top: 20px;
    padding: 0 14px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .btn-full-reset:hover {
    background: #fed7d7;
    border-color: #fc8181;
  }

  .footer {
    text-align: center;
    margin-top: 20px;
    font-size: 13px;
    font-weight: 500;
    color: rgba(255,255,255,0.7);
  }

  .dark-toggle {
    position: absolute;
    top: 16px;
    right: 16px;
    width: 42px;
    height: 42px;
    border-radius: 50%;
    border: none;
    background: rgba(255,255,255,0.2);
    color: white;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    padding: 0;
  }
  .dark-toggle:hover { background: rgba(255,255,255,0.3); }

  body.dark { background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%); }
  body.dark .card { background: rgba(45,55,72,0.97); color: #e2e8f0; }
  body.dark h1 { color: #e2e8f0; }
  body.dark .title-display .company-text { color: #e2e8f0; }
  body.dark .title-display .btn-edit-title { background: #4a5568; color: #a0aec0; }
  body.dark .title-display .btn-edit-title:hover { background: #2d3748; color: #e2e8f0; }
  body.dark .section-label { color: #a0aec0; }
  body.dark input { background: #4a5568; border-color: #4a5568; color: #e2e8f0; }
  body.dark input:focus { border-color: #667eea; background: #2d3748; }
  body.dark .bank-select-trigger { background: #4a5568; border-color: #4a5568; color: #e2e8f0; }
  body.dark .bank-select-trigger.placeholder { color: #718096; }
  body.dark .bank-select-trigger:hover { border-color: #667eea; background: #2d3748; }
  body.dark .bank-select.open .bank-select-trigger { border-color: #667eea; background: #2d3748; }
  body.dark .bank-select-trigger::after { color: #718096; }
  body.dark .bank-select-dropdown { background: #4a5568; border-color: #4a5568; box-shadow: 0 12px 28px rgba(0,0,0,0.3); }
  body.dark .bank-select-item { color: #e2e8f0; }
  body.dark .bank-select-item:hover { background: #2d3748; }
  body.dark .bank-select-item.selected { background: linear-gradient(135deg, #667eea, #764ba2); color: white; }
  body.dark .saved-display { background: #4a5568; border-color: #4a5568; color: #e2e8f0; }
  body.dark .btn-edit-pencil { background: #2d3748; color: #a0aec0; }
  body.dark .btn-edit-pencil:hover { background: #1a202c; color: #e2e8f0; }
  body.dark .btn-cancel-inline { background: #4a5568 !important; color: #a0aec0 !important; }
  body.dark .btn-cancel-inline:hover { background: #2d3748 !important; }
  body.dark .btn-danger { background: #742a2a; color: #feb2b2; }
  body.dark .btn-danger:hover { background: #9b2c2c; }
  body.dark thead th { background: #4a5568; color: #a0aec0; border-bottom-color: #4a5568; }
  body.dark td { border-bottom-color: #4a5568; color: #e2e8f0; }
  body.dark td:first-child { color: #e2e8f0; }
  body.dark .total-cell { color: #e2e8f0; }
  body.dark tbody tr:hover { background: rgba(102,126,234,0.1); }
  body.dark .counter-minus { background: #742a2a; color: #feb2b2; }
  body.dark .counter-plus { background: #22543d; color: #9ae6b4; }
  body.dark .btn-delete { background: #742a2a; color: #feb2b2; }
  body.dark .divider { background: linear-gradient(90deg, transparent, #4a5568, transparent); }
  body.dark .counter-control input { background: #2d3748; border-color: #4a5568; color: #e2e8f0; }
  body.dark .btn-full-reset { background: #2d2020; color: #fc8181; border-color: #742a2a; }
  body.dark .btn-full-reset:hover { background: #742a2a; border-color: #fc8181; }

  @media (max-width: 768px) {
    body { padding: 12px; padding-top: env(safe-area-inset-top, 12px); }
    .card { padding: 20px 16px; border-radius: 16px; }
    h1 { font-size: 24px; margin-bottom: 18px; }
    .title-display .company-text { font-size: 24px; }
    .input-group { flex-direction: column; gap: 8px; }
    .input-group.inline { flex-direction: row; }
    .btn-group { flex-wrap: wrap; }
    .btn-group button { flex: 1 1 calc(50% - 4px); min-width: 0; }
    .summary-banner { padding: 12px 14px; }
    .summary-item .value { font-size: 22px; }
    .summary-item .label { font-size: 12px; }
    table { font-size: 14px; }
    td { padding: 10px 4px; font-size: 15px; }
    .total-cell { font-size: 14px; }
    .counter-control input[type="number"] { width: 46px; font-size: 16px; }
    .counter-btn { width: 32px; height: 32px; font-size: 18px; }
    .dark-toggle { top: 20px; right: 20px; }
    .bank-select { width: 100px; }
    #accountHolder { width: 72px; }
  }

  @media (max-width: 380px) {
    .summary-item .value { font-size: 18px; }
    .counter-control input[type="number"] { width: 40px; }
    td { padding: 8px 2px; font-size: 14px; }
    .total-cell { font-size: 13px; }
    .bank-select { width: 88px; }
    #accountHolder { width: 64px; }
  }
</style>
</head>
<body>

<button class="dark-toggle" onclick="toggleDark()" title="Îã§ÌÅ¨Î™®Îìú Ï†ÑÌôò">üåô</button>

<div class="card" id="app">

  <div class="title-area">
    <div id="titleDisplay" style="display:none;">
      <div class="title-display">
        <span class="company-text" id="titleText"></span>
        <button class="btn-edit-title" onclick="editCompanyName()" title="ÌöåÏÇ¨Î™Ö ÏàòÏ†ï">‚úèÔ∏è</button>
      </div>
    </div>
    <div id="titleEditForm" style="display:none;">
      <h1 style="margin-bottom:12px;">üç± ÏõîÎßê Ï†êÏã¨Í∞í Í≥ÑÏÇ∞Í∏∞</h1>
      <div class="input-group inline" style="margin-bottom:0;">
        <input type="text" id="companyInput" placeholder="ÌöåÏÇ¨Î™Ö ÏûÖÎ†•" maxlength="20" onkeydown="if(event.key==='Enter') saveCompanyName();">
        <button class="btn-primary" onclick="saveCompanyName()" tabindex="-1">Ï†ÄÏû•</button>
        <button class="btn-primary btn-cancel-inline" id="btnCancelTitle" onclick="cancelEditCompany()" tabindex="-1" style="display:none;">Ï∑®ÏÜå</button>
        <button class="btn-danger" id="btnClearTitle" onclick="clearCompanyName()" tabindex="-1" style="display:none;">ÏÇ≠Ï†ú</button>
      </div>
    </div>
    <div id="titleDefault">
      <h1 style="cursor:pointer;" onclick="showCompanyEdit()" title="ÌÅ¥Î¶≠ÌïòÏó¨ ÌöåÏÇ¨Î™Ö ÏÑ§Ï†ï">üç± ÏõîÎßê Ï†êÏã¨Í∞í Í≥ÑÏÇ∞Í∏∞</h1>
    </div>
  </div>

  <span class="section-label">üí∞ Ï†êÏã¨Í∞í ÏÑ§Ï†ï</span>
  <div class="saved-display" id="priceDisplay" style="display:none;">
    <span class="saved-text" id="priceDisplayText"></span>
    <button class="btn-edit-pencil" onclick="editPrice()" title="Ï†êÏã¨Í∞í ÏàòÏ†ï">‚úèÔ∏è</button>
  </div>
  <div id="priceEditSection">
    <div class="input-group inline">
      <input type="number" id="price" placeholder="Ï†êÏã¨Í∞í ÏûÖÎ†•" onfocus="this.select()" onkeydown="handlePriceEnter(event)" inputmode="numeric" pattern="[0-9]*" />
      <button class="btn-primary" onclick="savePrice()" tabindex="-1">Ï†ÄÏû•</button>
      <button class="btn-primary btn-cancel-inline" id="btnCancelPrice" onclick="cancelEditPrice()" tabindex="-1" style="display:none;">Ï∑®ÏÜå</button>
    </div>
  </div>

  <div class="divider"></div>

  <span class="section-label">üí∏ ÏûÖÍ∏à Í≥ÑÏ¢å</span>
  <div class="saved-display" id="accountDisplay" style="display:none;">
    <span class="saved-text" id="accountDisplayText"></span>
    <button class="btn-edit-pencil" onclick="editAccount()" title="ÏûÖÍ∏à Í≥ÑÏ¢å ÏàòÏ†ï">‚úèÔ∏è</button>
  </div>
  <div id="accountEditSection">
    <div class="input-group inline">
      <div class="bank-select" id="bankSelect">
        <div class="bank-select-trigger placeholder" id="bankTrigger" onclick="toggleBankDropdown()">ÏùÄÌñâ ÏÑ†ÌÉù</div>
        <div class="bank-select-dropdown" id="bankDropdown"></div>
      </div>
      <input type="text" id="accountNumber" placeholder="Í≥ÑÏ¢åÎ≤àÌò∏" inputmode="numeric" onkeydown="handleAccountNumberEnter(event)">
      <input type="text" id="accountHolder" placeholder="ÏòàÍ∏àÏ£º" onkeydown="handleAccountHolderEnter(event)">
      <button class="btn-primary" onclick="saveAccount()" tabindex="-1">Ï†ÄÏû•</button>
      <button class="btn-primary btn-cancel-inline" id="btnCancelAccount" onclick="cancelEditAccount()" tabindex="-1" style="display:none;">Ï∑®ÏÜå</button>
    </div>
  </div>

  <div class="divider"></div>

  <span class="section-label">üë§ Ïù∏Ïõê ÏÑ§Ï†ï</span>
  <div class="input-group inline">
    <input type="text" id="nameInput" placeholder="Ïù¥Î¶Ñ ÏûÖÎ†•" onkeydown="handleEnter(event)">
    <button class="btn-add" onclick="addPerson()" tabindex="-1">‚ûï Ï∂îÍ∞Ä</button>
  </div>

  <div class="btn-group">
    <button class="btn-reset" onclick="resetPeople()" tabindex="-1">üóëÔ∏è Ï¥àÍ∏∞Ìôî</button>
    <button class="btn-copy" onclick="copyResult()" tabindex="-1">üìã Î≥µÏÇ¨</button>
    <button class="btn-export" onclick="exportCSV()" tabindex="-1">üì• CSV</button>
  </div>

  <div class="summary-banner" id="summaryBanner" style="display:none;">
    <div class="summary-item">
      <span class="label">Ïù∏Ïõê</span>
      <span class="value" id="sumPeople">0</span>
    </div>
    <div class="summary-item">
      <span class="label">Ï¥ù ÏãùÏÇ¨Ïàò</span>
      <span class="value" id="sumCount">0</span>
    </div>
    <div class="summary-item">
      <span class="label">Ï¥ù Í∏àÏï°</span>
      <span class="value" id="sumTotal">0Ïõê</span>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th style="width:8%"></th>
        <th style="width:22%">Ïù¥Î¶Ñ</th>
        <th style="width:32%">Î®πÏùÄ ÌöüÏàò</th>
        <th style="width:28%">Ïõî Ï†êÏã¨Í∞í</th>
        <th style="width:10%"></th>
      </tr>
    </thead>
    <tbody id="list"></tbody>
  </table>

  <div class="empty-state" id="emptyState">
    <div class="icon">üçΩÔ∏è</div>
    <p>ÏïÑÏßÅ Îì±Î°ùÎêú Ïù∏ÏõêÏù¥ ÏóÜÏäµÎãàÎã§.<br>ÏúÑÏóêÏÑú Ïù¥Î¶ÑÏùÑ Ï∂îÍ∞ÄÌï¥ Ï£ºÏÑ∏Ïöî!</p>
  </div>

  <button class="btn-full-reset" onclick="resetEverything()">‚ö†Ô∏è Ï†ÑÏ≤¥ Ï¥àÍ∏∞Ìôî (Î™®Îì† ÏÑ§Ï†ï ¬∑ Îç∞Ïù¥ÌÑ∞ ÏÇ≠Ï†ú)</button>

</div>

<div class="footer">Made by junyoung ‚ù§Ô∏è ¬∑ Îç∞Ïù¥ÌÑ∞Îäî Î∏åÎùºÏö∞Ï†ÄÏóê ÏûêÎèô Ï†ÄÏû•Îê©ÎãàÎã§</div>
<div class="toast" id="toast"></div>

<script>
let people = JSON.parse(localStorage.getItem("people")) || [];
let price = Number(localStorage.getItem("price")) || 6000;
let dragIdx = null;
let isEditMode = false;
let selectedBank = "";

const BANKS = [
  "Íµ≠ÎØº","Ïã†Ìïú","Ïö∞Î¶¨","ÌïòÎÇò","ÎÜçÌòë","Í∏∞ÏóÖ",
  "Ïπ¥Ïπ¥Ïò§Î±ÖÌÅ¨","ÌÜ†Ïä§Î±ÖÌÅ¨","ÏºÄÏù¥Î±ÖÌÅ¨",
  "SCÏ†úÏùº","Ïî®Ìã∞","Ïö∞Ï≤¥Íµ≠","ÏÉàÎßàÏùÑÍ∏àÍ≥†","Ïã†Ìòë","ÏàòÌòë",
  "ÎåÄÍµ¨","Î∂ÄÏÇ∞","Í¥ëÏ£º","Í≤ΩÎÇ®","Ï†ÑÎ∂Å","Ï†úÏ£º"
];

// =====================
// ÏùÄÌñâ ÌÅ¥Î¶≠Ìòï ÎìúÎ°≠Îã§Ïö¥
// =====================
const bankSelect = document.getElementById("bankSelect");
const bankTrigger = document.getElementById("bankTrigger");
const bankDropdown = document.getElementById("bankDropdown");

function buildBankDropdown() {
  bankDropdown.innerHTML = "";
  BANKS.forEach(bank => {
    const div = document.createElement("div");
    div.className = "bank-select-item" + (bank === selectedBank ? " selected" : "");
    div.textContent = bank;
    div.addEventListener("click", function(e) {
      e.stopPropagation();
      pickBank(bank);
    });
    bankDropdown.appendChild(div);
  });
}

function toggleBankDropdown() {
  const isOpen = bankSelect.classList.contains("open");
  if (isOpen) {
    closeBankDropdown();
  } else {
    buildBankDropdown();
    bankSelect.classList.add("open");
    // ÏÑ†ÌÉùÎêú Ìï≠Î™©ÏúºÎ°ú Ïä§ÌÅ¨Î°§
    setTimeout(() => {
      const sel = bankDropdown.querySelector(".selected");
      if (sel) sel.scrollIntoView({ block: "nearest" });
    }, 50);
  }
}

function pickBank(bank) {
  selectedBank = bank;
  bankTrigger.textContent = bank;
  bankTrigger.classList.remove("placeholder");
  closeBankDropdown();
  document.getElementById("accountNumber").focus();
}

function closeBankDropdown() {
  bankSelect.classList.remove("open");
}

function resetBankSelect() {
  selectedBank = "";
  bankTrigger.textContent = "ÏùÄÌñâ ÏÑ†ÌÉù";
  bankTrigger.classList.add("placeholder");
}

function setBankSelect(bank) {
  if (bank && BANKS.includes(bank)) {
    selectedBank = bank;
    bankTrigger.textContent = bank;
    bankTrigger.classList.remove("placeholder");
  } else {
    resetBankSelect();
  }
}

document.addEventListener("click", function(e) {
  if (!e.target.closest("#bankSelect")) closeBankDropdown();
});

document.addEventListener("keydown", function(e) {
  if (!bankSelect.classList.contains("open")) return;
  if (e.key === "Escape") { closeBankDropdown(); return; }
  // ÌÇ§Î≥¥ÎìúÎ°ú Ï≤´ Í∏ÄÏûê Îπ†Î•∏ ÌÉêÏÉâ
  if (e.key.length === 1) {
    const match = BANKS.find(b => b.startsWith(e.key));
    if (match) {
      pickBank(match);
    }
  }
});

function handleAccountNumberEnter(e) {
  if (e.key === "Enter") {
    e.preventDefault();
    document.getElementById("accountHolder").focus();
  }
}

function handleAccountHolderEnter(e) {
  if (e.key === "Enter") {
    e.preventDefault();
    saveAccount();
  }
}

// =====================
// Ï¥àÍ∏∞ ÏÑ§Ï†ï ÌùêÎ¶Ñ
// =====================
function isInitialSetup() {
  return !(localStorage.getItem("companyName") && localStorage.getItem("price") && localStorage.getItem("account"));
}

function focusNextUnsaved() {
  if (!localStorage.getItem("companyName")) { showCompanyEdit(); return; }
  if (!localStorage.getItem("price") || Number(localStorage.getItem("price")) <= 0) {
    showPriceEdit(false);
    setTimeout(() => document.getElementById("price").focus(), 100);
    return;
  }
  const acct = JSON.parse(localStorage.getItem("account") || "{}");
  if (!acct.bank || !acct.number || !acct.holder) {
    showAccountEdit(false);
    return;
  }
  focusNameInput();
}

function focusNameInput() {
  setTimeout(() => document.getElementById("nameInput").focus(), 100);
}

// =====================
// ÌöåÏÇ¨Î™Ö
// =====================
function initTitleView() {
  const company = localStorage.getItem("companyName") || "";
  if (company) { showTitleDisplay(company); }
  else {
    document.getElementById("titleDefault").style.display = "block";
    document.getElementById("titleDisplay").style.display = "none";
    document.getElementById("titleEditForm").style.display = "none";
  }
}

function showTitleDisplay(name) {
  document.getElementById("titleDefault").style.display = "none";
  document.getElementById("titleEditForm").style.display = "none";
  document.getElementById("titleDisplay").style.display = "block";
  document.getElementById("titleText").textContent = `üç± ${name} ÏõîÎßê Ï†êÏã¨Í∞í Í≥ÑÏÇ∞Í∏∞`;
}

function showCompanyEdit() {
  const company = localStorage.getItem("companyName") || "";
  isEditMode = !!company;
  document.getElementById("titleDefault").style.display = "none";
  document.getElementById("titleDisplay").style.display = "none";
  document.getElementById("titleEditForm").style.display = "block";
  document.getElementById("companyInput").value = company;
  document.getElementById("btnCancelTitle").style.display = company ? "inline-flex" : "none";
  document.getElementById("btnClearTitle").style.display = company ? "inline-flex" : "none";
  setTimeout(() => document.getElementById("companyInput").focus(), 100);
}

function editCompanyName() { showCompanyEdit(); }

function saveCompanyName() {
  const name = document.getElementById("companyInput").value.trim();
  if (!name) { showToast("ÌöåÏÇ¨Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî", "error"); return; }
  const wasEdit = isEditMode;
  localStorage.setItem("companyName", name);
  showTitleDisplay(name);
  showToast(`"${name}" Ï†ÄÏû• ÏôÑÎ£å!`);
  if (wasEdit) { focusNameInput(); } else { focusNextUnsaved(); }
}

function cancelEditCompany() {
  const company = localStorage.getItem("companyName") || "";
  if (company) { showTitleDisplay(company); }
  else {
    document.getElementById("titleDefault").style.display = "block";
    document.getElementById("titleEditForm").style.display = "none";
    document.getElementById("titleDisplay").style.display = "none";
  }
}

function clearCompanyName() {
  if (!confirm("ÌöåÏÇ¨Î™ÖÏùÑ ÏÇ≠Ï†úÌï†ÍπåÏöî?")) return;
  localStorage.removeItem("companyName");
  document.getElementById("titleDefault").style.display = "block";
  document.getElementById("titleEditForm").style.display = "none";
  document.getElementById("titleDisplay").style.display = "none";
  showToast("ÌöåÏÇ¨Î™Ö ÏÇ≠Ï†úÎê®", "info");
}

initTitleView();

// =====================
// Ï†êÏã¨Í∞í
// =====================
function initPriceView() {
  const saved = localStorage.getItem("price");
  if (saved && Number(saved) > 0) { price = Number(saved); showPriceDisplay(); }
  else { showPriceEdit(false); }
}

function showPriceDisplay() {
  document.getElementById("priceDisplay").style.display = "flex";
  document.getElementById("priceEditSection").style.display = "none";
  document.getElementById("priceDisplayText").textContent = formatWon(price);
}

function showPriceEdit(showCancel) {
  document.getElementById("priceDisplay").style.display = "none";
  document.getElementById("priceEditSection").style.display = "block";
  document.getElementById("btnCancelPrice").style.display = showCancel ? "inline-flex" : "none";
  const saved = localStorage.getItem("price");
  document.getElementById("price").value = (saved && Number(saved) > 0) ? Number(saved) : "";
}

function editPrice() {
  isEditMode = true;
  showPriceEdit(true);
  setTimeout(() => document.getElementById("price").focus(), 100);
}

function cancelEditPrice() { showPriceDisplay(); }

function handlePriceEnter(e) {
  if (e.key !== "Enter") return;
  e.preventDefault();
  savePrice();
}

function savePrice() {
  const val = Number(document.getElementById("price").value);
  if (val <= 0) { showToast("Ïò¨Î∞îÎ•∏ Í∏àÏï°ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî", "error"); return; }
  const wasFirstSave = !localStorage.getItem("price") || Number(localStorage.getItem("price")) <= 0;
  price = val;
  localStorage.setItem("price", price);
  showPriceDisplay();
  updateTotalsOnly();
  updateSummary();
  showToast(`Ï†êÏã¨Í∞í ${formatWon(price)}ÏúºÎ°ú Ï†ÄÏû•!`);
  if (isEditMode && !wasFirstSave) { focusNameInput(); } else { focusNextUnsaved(); }
  isEditMode = false;
}

initPriceView();

// =====================
// Í≥ÑÏ¢å
// =====================
function initAccountView() {
  const a = JSON.parse(localStorage.getItem("account")) || {};
  if (a.bank && a.number && a.holder) { showAccountDisplay(); }
  else { showAccountEdit(false); }
}

function showAccountDisplay() {
  const a = JSON.parse(localStorage.getItem("account")) || {};
  document.getElementById("accountDisplay").style.display = "flex";
  document.getElementById("accountEditSection").style.display = "none";
  document.getElementById("accountDisplayText").textContent = `${a.bank}  ${a.number}  ${a.holder}`;
}

function showAccountEdit(showCancel) {
  const a = JSON.parse(localStorage.getItem("account")) || {};
  document.getElementById("accountDisplay").style.display = "none";
  document.getElementById("accountEditSection").style.display = "block";
  document.getElementById("btnCancelAccount").style.display = showCancel ? "inline-flex" : "none";
  setBankSelect(a.bank || "");
  if (a.number) document.getElementById("accountNumber").value = a.number;
  if (a.holder) document.getElementById("accountHolder").value = a.holder;
}

function editAccount() {
  isEditMode = true;
  showAccountEdit(true);
}

function saveAccount() {
  const bank = selectedBank;
  const number = document.getElementById("accountNumber").value.trim();
  const holder = document.getElementById("accountHolder").value.trim();
  if (!bank) {
    showToast("ÏùÄÌñâÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî", "error");
    toggleBankDropdown();
    return;
  }
  if (!number || !holder) {
    showToast("Í≥ÑÏ¢åÎ≤àÌò∏ÏôÄ ÏòàÍ∏àÏ£ºÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî", "error");
    if (!number) document.getElementById("accountNumber").focus();
    else document.getElementById("accountHolder").focus();
    return;
  }
  const wasFirstSave = !localStorage.getItem("account") ||
    (() => { const a = JSON.parse(localStorage.getItem("account") || "{}"); return !a.bank || !a.number || !a.holder; })();
  localStorage.setItem("account", JSON.stringify({ bank, number, holder }));
  showAccountDisplay();
  showToast("üí∏ Í≥ÑÏ¢å Ï†ïÎ≥¥ Ï†ÄÏû•!", "info");
  if (isEditMode && !wasFirstSave) { focusNameInput(); } else { focusNextUnsaved(); }
  isEditMode = false;
}

function cancelEditAccount() { showAccountDisplay(); }

function getAccountString() {
  const a = JSON.parse(localStorage.getItem("account")) || {};
  if (a.bank && a.number && a.holder) return `${a.bank} ${a.number} ${a.holder}`;
  return "";
}

initAccountView();

if (isInitialSetup()) { setTimeout(() => focusNextUnsaved(), 300); }

// =====================
// Dark mode
// =====================
if (localStorage.getItem("dark") === "1") {
  document.body.classList.add("dark");
  document.querySelector(".dark-toggle").textContent = "‚òÄÔ∏è";
}

function toggleDark() {
  const isDark = document.body.classList.toggle("dark");
  localStorage.setItem("dark", isDark ? "1" : "0");
  document.querySelector(".dark-toggle").textContent = isDark ? "‚òÄÔ∏è" : "üåô";
}

function showToast(msg, type = "success") {
  const t = document.getElementById("toast");
  t.textContent = msg;
  t.className = "toast " + type;
  void t.offsetWidth;
  t.classList.add("show");
  setTimeout(() => t.classList.remove("show"), 2200);
}

function handleEnter(e) { if (e.key === "Enter") addPerson(); }

function addPerson() {
  const input = document.getElementById("nameInput");
  const name = input.value.trim();
  if (!name) { showToast("Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî", "error"); input.focus(); return; }
  if (people.some(p => p.name === name)) { showToast("Ïù¥ÎØ∏ Îì±Î°ùÎêú Ïù¥Î¶ÑÏûÖÎãàÎã§", "error"); input.select(); return; }
  people.push({ name, count: 0 });
  input.value = "";
  input.focus();
  saveAll();
  showToast(`${name} Ï∂îÍ∞Ä ÏôÑÎ£å!`);
  setTimeout(() => {
    const rows = document.querySelectorAll("#list tr");
    const last = rows[rows.length - 1];
    if (last) last.classList.add("highlight");
  }, 50);
}

function removePerson(index) {
  const name = people[index].name;
  people.splice(index, 1);
  saveAll();
  showToast(`${name} ÏÇ≠Ï†úÎê®`, "info");
}

function resetPeople() {
  if (people.length === 0) { showToast("Ï¥àÍ∏∞ÌôîÌï† Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§", "error"); return; }
  if (!confirm("Ïù∏Ïõê Î™©Î°ùÍ≥º ÌöüÏàòÎ•º Ï¥àÍ∏∞ÌôîÌï†ÍπåÏöî?")) return;
  people = [];
  localStorage.removeItem("people");
  render();
  updateSummary();
  showToast("Ïù∏Ïõê Î™©Î°ù Ï¥àÍ∏∞Ìôî ÏôÑÎ£å!", "info");
}

function resetEverything() {
  if (!confirm("‚ö†Ô∏è ÌöåÏÇ¨Î™Ö, Ï†êÏã¨Í∞í, Í≥ÑÏ¢å, Ïù∏Ïõê Îì±\nÎ™®Îì† ÏÑ§Ï†ïÍ≥º Îç∞Ïù¥ÌÑ∞Î•º ÏÇ≠Ï†úÌï†ÍπåÏöî?\n\nÏù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§.")) return;
  const darkMode = localStorage.getItem("dark");
  localStorage.clear();
  if (darkMode) localStorage.setItem("dark", darkMode);

  people = [];
  price = 6000;

  document.getElementById("companyInput").value = "";
  document.getElementById("price").value = "";
  resetBankSelect();
  document.getElementById("accountNumber").value = "";
  document.getElementById("accountHolder").value = "";
  document.getElementById("nameInput").value = "";

  document.getElementById("titleDefault").style.display = "block";
  document.getElementById("titleDisplay").style.display = "none";
  document.getElementById("titleEditForm").style.display = "none";

  document.getElementById("priceDisplay").style.display = "none";
  document.getElementById("priceEditSection").style.display = "block";
  document.getElementById("btnCancelPrice").style.display = "none";

  document.getElementById("accountDisplay").style.display = "none";
  document.getElementById("accountEditSection").style.display = "block";
  document.getElementById("btnCancelAccount").style.display = "none";

  render();
  updateSummary();
  showToast("‚ö†Ô∏è Ï†ÑÏ≤¥ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å!", "error");
  setTimeout(() => focusNextUnsaved(), 500);
}

function saveAll() {
  localStorage.setItem("people", JSON.stringify(people));
  render();
  updateSummary();
}

function formatWon(num) { return num.toLocaleString("ko-KR") + "Ïõê"; }

function render() {
  const tbody = document.getElementById("list");
  const empty = document.getElementById("emptyState");
  tbody.innerHTML = "";
  if (people.length === 0) {
    empty.style.display = "block";
    document.getElementById("summaryBanner").style.display = "none";
    return;
  }
  empty.style.display = "none";
  document.getElementById("summaryBanner").style.display = "flex";
  people.forEach((p, i) => {
    const tr = document.createElement("tr");
    tr.draggable = true;
    tr.dataset.index = i;
    tr.innerHTML = `
      <td><span class="drag-handle" title="ÎìúÎûòÍ∑∏ÌïòÏó¨ ÏàúÏÑú Î≥ÄÍ≤Ω">‚†ø</span></td>
      <td>${escapeHtml(p.name)}</td>
      <td>
        <div class="counter-control">
          <button class="counter-btn counter-minus" data-idx="${i}" data-dir="-1" tabindex="-1">‚àí</button>
          <input type="number" min="0" step="1" inputmode="numeric" pattern="[0-9]*" value="${p.count}" data-index="${i}" onfocus="this.select()">
          <button class="counter-btn counter-plus" data-idx="${i}" data-dir="1" tabindex="-1">+</button>
        </div>
      </td>
      <td class="total-cell">${formatWon(p.count * price)}</td>
      <td><button class="btn-delete" tabindex="-1" title="ÏÇ≠Ï†ú">‚úï</button></td>
    `;
    tr.querySelector(".btn-delete").onclick = () => removePerson(i);
    tr.addEventListener("dragstart", handleDragStart);
    tr.addEventListener("dragover", handleDragOver);
    tr.addEventListener("dragleave", handleDragLeave);
    tr.addEventListener("drop", handleDrop);
    tr.addEventListener("dragend", handleDragEnd);
    tbody.appendChild(tr);
  });
  updateSummary();
}

function escapeHtml(str) {
  const div = document.createElement("div");
  div.textContent = str;
  return div.innerHTML;
}

document.getElementById("list").addEventListener("click", function(e) {
  const btn = e.target.closest(".counter-btn");
  if (!btn) return;
  const idx = Number(btn.dataset.idx);
  const dir = Number(btn.dataset.dir);
  people[idx].count = Math.max(0, people[idx].count + dir);
  btn.parentElement.querySelector("input").value = people[idx].count;
  localStorage.setItem("people", JSON.stringify(people));
  updateTotalsOnly();
  updateSummary();
});

document.getElementById("list").addEventListener("input", function(e) {
  if (e.target.tagName !== "INPUT") return;
  const idx = Number(e.target.dataset.index);
  let raw = e.target.value.replace(/[^0-9]/g, '').replace(/^0+(?=\d)/, '');
  const val = raw === "" ? 0 : Number(raw);
  e.target.value = val;
  people[idx].count = val;
  localStorage.setItem("people", JSON.stringify(people));
  updateTotalsOnly();
  updateSummary();
});

function updateTotalsOnly() {
  document.querySelectorAll("#list tr").forEach((tr, i) => {
    const totalCell = tr.querySelector(".total-cell");
    if (totalCell && people[i]) totalCell.textContent = formatWon(people[i].count * price);
  });
}

function updateSummary() {
  if (people.length === 0) return;
  document.getElementById("sumPeople").textContent = people.length + "Î™Ö";
  const totalCount = people.reduce((s, p) => s + p.count, 0);
  document.getElementById("sumCount").textContent = totalCount + "Ìöå";
  document.getElementById("sumTotal").textContent = formatWon(totalCount * price);
}

document.getElementById("list").addEventListener("keydown", function(e) {
  if (e.key !== "Tab" && e.key !== "Enter") return;
  const inputs = Array.from(document.querySelectorAll('#list input[type="number"]'));
  const current = document.activeElement;
  const idx = inputs.indexOf(current);
  if (idx === -1) return;
  e.preventDefault();
  if (e.shiftKey && e.key === "Tab") {
    inputs[idx === 0 ? inputs.length - 1 : idx - 1].focus();
  } else {
    inputs[idx === inputs.length - 1 ? 0 : idx + 1].focus();
  }
});

function handleDragStart(e) {
  dragIdx = Number(this.dataset.index);
  this.classList.add("dragging");
  e.dataTransfer.effectAllowed = "move";
}
function handleDragOver(e) {
  e.preventDefault();
  e.dataTransfer.dropEffect = "move";
  this.classList.add("drag-over");
}
function handleDragLeave() { this.classList.remove("drag-over"); }
function handleDrop(e) {
  e.preventDefault();
  this.classList.remove("drag-over");
  const dropIdx = Number(this.dataset.index);
  if (dragIdx === null || dragIdx === dropIdx) return;
  const [moved] = people.splice(dragIdx, 1);
  people.splice(dropIdx, 0, moved);
  saveAll();
  showToast("ÏàúÏÑú Î≥ÄÍ≤ΩÎê®", "info");
}
function handleDragEnd() {
  this.classList.remove("dragging");
  document.querySelectorAll(".drag-over").forEach(el => el.classList.remove("drag-over"));
  dragIdx = null;
}

function copyResult() {
  if (people.length === 0) { showToast("Î≥µÏÇ¨Ìï† Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§", "error"); return; }
  const now = new Date();
  const company = localStorage.getItem("companyName") || "";
  const prefix = company ? `${company} ` : "";
  const title = `üìÖ ${prefix}${now.getFullYear()}ÎÖÑ ${now.getMonth()+1}Ïõî Ï†êÏã¨ Ï†ïÏÇ∞`;
  const divider = "‚îÄ".repeat(24);
  const lines = people.map(p => {
    const total = p.count * price;
    return `  ${p.name}  ‚îÇ  ${price.toLocaleString()} √ó ${p.count}Ìöå  =  ${total.toLocaleString("ko-KR")}Ïõê`;
  });
  const parts = [title, divider, ...lines, divider];
  const accountStr = getAccountString();
  if (accountStr) parts.push(`  ${accountStr}`);
  const resultText = parts.join("\n");
  navigator.clipboard.writeText(resultText).then(() => {
    showToast("üìã Ï†ïÏÇ∞ ÎÇ¥Ïó≠ Î≥µÏÇ¨ ÏôÑÎ£å!");
  }).catch(() => {
    const ta = document.createElement("textarea");
    ta.value = resultText;
    document.body.appendChild(ta);
    ta.select();
    document.execCommand("copy");
    document.body.removeChild(ta);
    showToast("üìã Ï†ïÏÇ∞ ÎÇ¥Ïó≠ Î≥µÏÇ¨ ÏôÑÎ£å!");
  });
}

function exportCSV() {
  if (people.length === 0) { showToast("ÎÇ¥Î≥¥ÎÇº Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§", "error"); return; }
  const now = new Date();
  const month = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}`;
  let csv = "\uFEFFÏù¥Î¶Ñ,ÌöüÏàò,Îã®Í∞Ä,Ìï©Í≥Ñ\n";
  people.forEach(p => { csv += `${p.name},${p.count},${price},${p.count * price}\n`; });
  const a = JSON.parse(localStorage.getItem("account")) || {};
  if (a.bank && a.number && a.holder) {
    csv += `\nÏûÖÍ∏àÍ≥ÑÏ¢å,${a.bank} ${a.number} ${a.holder},,\n`;
  }
  const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
  const url = URL.createObjectURL(blob);
  const link = document.createElement("a");
  link.href = url;
  link.download = `Ï†êÏã¨Ï†ïÏÇ∞_${month}.csv`;
  link.click();
  URL.revokeObjectURL(url);
  showToast("üì• CSV ÌååÏùº Îã§Ïö¥Î°úÎìú!", "success");
}

render();
buildBankDropdown();
</script>

</body>
</html>
